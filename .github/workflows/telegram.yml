name: Telegram Scheduled Message

on:
  schedule:
    # â†“ UTC ê¸°ì¤€ìž…ë‹ˆë‹¤. (KSTëŠ” +9ì‹œê°„) ì˜ˆ: KST 10:00 = UTC 01:00
    - cron: "0 1 * * *"
  # ìˆ˜ë™ í…ŒìŠ¤íŠ¸ ë²„íŠ¼ë„ ìƒì„±
  workflow_dispatch: {}

jobs:
  send:
    runs-on: ubuntu-latest
    steps:
      - name: Compose message (KST time-stamp)
        id: msg
        run: |
          # GitHub ActionsëŠ” UTCë¼ì„œ +9ì‹œê°„ ë”í•œ í•œêµ­ì‹œê°„ í‘œê¸°
          KST_NOW=$(date -u -d '9 hours' +'%Y-%m-%d %H:%M KST (%a)')
          echo "MSG=ðŸ“£ ì •ê¸° ê³µì§€ìž…ë‹ˆë‹¤. (${KST_NOW})" >> $GITHUB_OUTPUT

      - name: Send to Telegram
        run: |
          curl -sS -X POST "https://api.telegram.org/bot${{ secrets.BOT_TOKEN }}/sendMessage" \
            -H "Content-Type: application/json" \
            -d '{"chat_id":"'"${{ secrets.CHAT_ID }}"'",
                 "text":"'"${{ steps.msg.outputs.MSG }}"'",
                 "parse_mode":"HTML"}'
