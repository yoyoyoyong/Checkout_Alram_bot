name: Telegram 17시47분 알림

on:
  schedule:
    # UTC 기준: KST(UTC+9) → 17:47 = UTC 08:47
    - cron: "47 8 * * *"
  workflow_dispatch: {}

jobs:
  send:
    runs-on: ubuntu-latest
    steps:
      - name: Compose message (퇴실체크 안내)
        id: msg
        run: |
          KST_NOW=$(date -u -d '9 hours' +'%Y-%m-%d (%a) KST')
          echo "MSG=퇴실체크 안내 부탁드립니다:) (${KST_NOW})" >> $GITHUB_OUTPUT

      - name: Send Telegram Message
        run: |
          curl -sS -X POST "https://api.telegram.org/bot${{ secrets.BOT_TOKEN }}/sendMessage" \
            -H "Content-Type: application/json" \
            -d '{"chat_id": "'"${{ secrets.CHAT_ID }}"'", 
                 "text": "'"${{ steps.msg.outputs.MSG }}"'", 
                 "parse_mode": "HTML"}'
